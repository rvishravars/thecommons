name: Version Consistency Check

on:
  pull_request:
    paths:
      - 'MANIFESTO.md'
      - 'README.md'

jobs:
  check-version:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Extract and Validate Versions
        run: |
          # Extract version from MANIFESTO.md
          MANIFESTO_VERSION=$(grep -oP 'Master Framework \(v\K[0-9.]+' MANIFESTO.md | head -1)
          echo "Manifesto version: v$MANIFESTO_VERSION"
          
          # Extract version from README.md
          README_VERSION=$(grep -oP 'Manifesto v\K[0-9.]+' README.md | head -1)
          echo "README version: v$README_VERSION"
          
          # Check consistency
          if [ "$MANIFESTO_VERSION" != "$README_VERSION" ]; then
            echo ""
            echo "❌ Version mismatch: MANIFESTO.md (v$MANIFESTO_VERSION) != README.md (v$README_VERSION)"
            echo "⚠️ Version inconsistency detected across documentation files."
            echo "Please ensure all files reference version v$MANIFESTO_VERSION"
            exit 1
          fi
          
          echo "✅ All version references are consistent: v$MANIFESTO_VERSION"
